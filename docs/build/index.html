<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example.jl Documentation · NeuralEstimators.jl</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href><img src="assets/logo.png" alt="NeuralEstimators.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href>NeuralEstimators.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Example.jl Documentation</a><ul class="internal"><li><a class="tocitem" href="#Functions"><span>Functions</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Example.jl Documentation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Example.jl Documentation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/msainsburydale/NeuralEstimators.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Example.jl-Documentation"><a class="docs-heading-anchor" href="#Example.jl-Documentation">Example.jl Documentation</a><a id="Example.jl-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Example.jl-Documentation" title="Permalink"></a></h1><ul><li><a href="#Example.jl-Documentation">Example.jl Documentation</a></li><li class="no-marker"><ul><li><a href="#Functions">Functions</a></li><li><a href="#Index">Index</a></li></ul></li></ul><h2 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="NeuralEstimators.func-Tuple{Any}" href="#NeuralEstimators.func-Tuple{Any}"><code>NeuralEstimators.func</code></a> — <span class="docstring-category">Method</span></header><section><div><p><strong>General work flow</strong></p><p>The first step is to define Ω, the prior distribution for the p-dimensional parameter vector, θ. This can be an object of any type. We also need a method <code>sample(Ω, K)</code> that returns K samples of θ as a p × K matrix.</p><pre><code class="nohighlight hljs">Ω = Normal(0, 0.5)
sample(Ω, K) = rand(Ω, K)&#39;</code></pre><p>Next, we define a <code>struct</code>, whose name is arbitrary, which must have the field θ but can store other information. Storing information in a <code>struct</code> is somewhat redundant for the current simple model but is useful for more complicated models, as will be shown later, and it is needed for the different variants of on-the-fly and just-in-time simulation, also discussed later. So, for consistency, we require it across the board. We also define a constructor.</p><pre><code class="nohighlight hljs">struct Parameters &lt;: ParameterConfigurations
    θ
end</code></pre><p>Next, we implicitly define the statistical model by providing a simulate() method for data simulation conditional on θ. The function takes two arguments, θ and <code>m</code>, with the type of <code>m</code> depending on the values the estimator will be used for (e.g., a single sample size, in which case m will be an Integer). Irrespective of the type of m, simulate() should return a a vector of (multi-dimensional) arrays.</p><pre><code class="nohighlight hljs">simulate(params::Parameters, m::Integer) = [rand(Normal(t, 1), θ) for t ∈ params.θ]</code></pre><p>We then choose an architecture for modelling ψ(⋅) and ϕ(⋅) in the Deep Set framework, and initialise the neural estimator as a DeepSet object.</p><pre><code class="nohighlight hljs">p = 1
w = 32
q = 16
ψ = Chain(Dense(n, w, relu), Dense(w, q, relu))
ϕ = Chain(Dense(q, w, relu), Dense(w, p), flatten)
θ̂ = DeepSet(ψ, ϕ)</code></pre><p>Train the neural estimator using <code>train()</code>. This optimisation is performed with respect to an arbitrary loss function L (default absolute error loss).</p><pre><code class="nohighlight hljs">θ̂ = train(θ̂, Ω, m = 1, ...)</code></pre><p>θ̂ now approximates the Bayes estimator for θ. The performance of θ̂ can be tested using the function estimate(), which tests θ̂ on a set of testing parameters sampled from Ω. The estimates are saved as a .csv file for convenience.</p><pre><code class="nohighlight hljs">estimate(θ̂, Ω, ...)</code></pre><p><strong>Variants of on-the-fly and just-in-time simulation</strong></p><p>The above approach assumes that θ and Z are continuously refreshed every epoch. This approach is the simplest, most theoretically justified, and has the best memory complexity, since both θ and Z can be simulated just-in-time; however, it is also the most time expensive. There are two alternatives to this approach:</p><ul><li>Refresh θ every x epochs, refresh Z every epoch. This can reduce time complexity if generating parameters involves computationally expensive terms, such as Cholesky factors, and memory complexity may be kept low since Z can still be simulated just-in-time.</li><li>refresh θ every x epochs, refresh Z every y&gt;x epochs. This minimises time complexity but has the large memory complexity, since both θ and Z cannot be simulated just-in-time and must be stored in full.</li></ul><p>To cater for these variants, another <code>train()</code> method is available, which takes the additional argument <code>params</code> (discussed below), and the keyword arguments <code>epochs_per_θ_refresh</code> and <code>epochs_per_Z_refresh</code>.</p><p>The argument <code>params</code> should be a struct whose only requirement is a field named θ, which stores the parameters. In addition to being needed for the simulation variants discussed above, this struct is also useful in more complicated models when re-using expensive terms, like Cholesky factors, can significantly reduce the computational burden. The name of the struct is arbitrary, but it is usually convenient to name it in reflection of the statistic model.</p><pre><code class="nohighlight hljs">struct NormalParameterConfigurations
    θ
end</code></pre><p>Then, the neural estimator is trained as before.</p><pre><code class="nohighlight hljs">θ̂ = train(θ̂, Ω, NormalParameterConfigurations, epochs_per_θ_refresh = 5, epochs_per_Z_refresh = 10)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/msainsburydale/NeuralEstimators.jl/blob/5cf77eab1133cf9f560530e3a33f842e15afe50f/src/NeuralEstimators.jl#L7-L93">source</a></section></article><ul><li>link to <a href="#Example.jl-Documentation">Example.jl Documentation</a></li><li>link to <a href="#NeuralEstimators.func-Tuple{Any}"><code>func(x)</code></a></li></ul><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#NeuralEstimators.func-Tuple{Any}"><code>NeuralEstimators.func</code></a></li></ul></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Wednesday 22 June 2022 15:10">Wednesday 22 June 2022</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
