<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Core functions · NeuralEstimators.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralEstimators.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralEstimators.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../backgroundtheory/">Background theory</a></li><li><span class="tocitem">Workflow</span><ul><li><a class="tocitem" href="../../workflow/overview/">Overview</a></li><li><a class="tocitem" href="../../workflow/simple/">Simple example</a></li><li><a class="tocitem" href="../../workflow/complex/">More complicated example</a></li><li><a class="tocitem" href="../../workflow/advanced/">Advanced usage</a></li></ul></li><li><span class="tocitem">API</span><ul><li class="is-active"><a class="tocitem" href>Core functions</a><ul class="internal"><li><a class="tocitem" href="#Deep-Set-representation"><span>Deep Set representation</span></a></li><li><a class="tocitem" href="#Simulation"><span>Simulation</span></a></li><li><a class="tocitem" href="#Training"><span>Training</span></a></li><li><a class="tocitem" href="#Estimation"><span>Estimation</span></a></li><li><a class="tocitem" href="#Bootstrapping"><span>Bootstrapping</span></a></li></ul></li><li><a class="tocitem" href="../simulation/">Data simulation</a></li><li><a class="tocitem" href="../utility/">Utility functions</a></li><li><a class="tocitem" href="../">Index</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li class="is-active"><a href>Core functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Core functions</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/msainsburydale/NeuralEstimators.jl/blob/main/docs/src/API/core.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Core-functions"><a class="docs-heading-anchor" href="#Core-functions">Core functions</a><a id="Core-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Core-functions" title="Permalink"></a></h1><h2 id="Deep-Set-representation"><a class="docs-heading-anchor" href="#Deep-Set-representation">Deep Set representation</a><a id="Deep-Set-representation-1"></a><a class="docs-heading-anchor-permalink" href="#Deep-Set-representation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="NeuralEstimators.DeepSet" href="#NeuralEstimators.DeepSet"><code>NeuralEstimators.DeepSet</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DeepSet(ψ, ϕ, agg)</code></pre><p>Implementation of the Deep Set framework, where <code>ψ</code> and <code>ϕ</code> are neural networks (e.g., <code>Flux</code> networks) and <code>agg</code> is a symmetric function that pools data over the last dimension (the replicates/batch dimension) of an array.</p><p><code>DeepSet</code> objects are applied to <code>AbstractVectors</code> of <code>AbstractArrays</code>, where each array is associated with one parameter vector.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">n = 10 # observations in each realisation
p = 5  # number of parameters in the statistical model 
w = 32 # width of each layer
ψ = Chain(Dense(n, w, relu), Dense(w, w, relu));
ϕ = Chain(Dense(w, w, relu), Dense(w, p));
agg(X) = sum(X, dims = ndims(X))
θ̂  = DeepSet(ψ, ϕ, agg)

# A single set of m=3 realisations:
Z = [rand(n, 1, 3)];
θ̂ (Z)

# Two sets each containing m=3 realisations:
Z = [rand(n, 1, m) for m ∈ (3, 3)];
θ̂ (Z)

# Two sets respectivaly containing m=3 and m=4 realisations:
Z = [rand(n, 1, m) for m ∈ (3, 4)];
θ̂ (Z)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/msainsburydale/NeuralEstimators.jl/blob/409f69aac499efd89136ff204f3afda637c91bac/src/DeepSet.jl#L25-L57">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NeuralEstimators.DeepSet-Tuple{Any, Any}" href="#NeuralEstimators.DeepSet-Tuple{Any, Any}"><code>NeuralEstimators.DeepSet</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">DeepSet(ψ, ϕ; aggregation::String = &quot;mean&quot;)</code></pre><p>Convenient constructor for a <code>DeepSet</code> object with <code>agg</code> equal to the <code>&quot;mean&quot;</code>, <code>&quot;sum&quot;</code>, or <code>&quot;log-sum-exp&quot;</code> function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/msainsburydale/NeuralEstimators.jl/blob/409f69aac499efd89136ff204f3afda637c91bac/src/DeepSet.jl#L66-L71">source</a></section></article><h2 id="Simulation"><a class="docs-heading-anchor" href="#Simulation">Simulation</a><a id="Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="NeuralEstimators.simulate" href="#NeuralEstimators.simulate"><code>NeuralEstimators.simulate</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">simulate(parameters::P, m::Integer, num_rep::Integer) where {P &lt;: ParameterConfigurations}</code></pre><p>Generic method that simulates <code>m</code> independent replicates for each parameter configuration (by internally calling <code>simulate(parameters, m)</code>), repeated a total of <code>num_rep</code> times.</p><p>See also <a href="../simulation/#Data-simulation">Data simulation</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/msainsburydale/NeuralEstimators.jl/blob/409f69aac499efd89136ff204f3afda637c91bac/src/DataSimulation.jl#L1-L9">source</a></section></article><h2 id="Training"><a class="docs-heading-anchor" href="#Training">Training</a><a id="Training-1"></a><a class="docs-heading-anchor-permalink" href="#Training" title="Permalink"></a></h2><p>There are two training methods. For both methods, the validation parameters and validation data are held fixed so that the validation risk is interpretable. There are a number of practical considerations to keep in mind: In particular, see <a href="../../workflow/advanced/#Balancing-time-and-memory-complexity">Balancing time and memory complexity</a>.</p><article class="docstring"><header><a class="docstring-binding" id="NeuralEstimators.train" href="#NeuralEstimators.train"><code>NeuralEstimators.train</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">train(θ̂, ξ, P; &lt;keyword args&gt;) where {P &lt;: ParameterConfigurations}</code></pre><p>Train the neural estimator <code>θ̂</code> by providing the objects <code>ξ</code> needed for the constructor <code>P</code> to automatically sample the set of training and validation parameters, which may be refreshed periodically throughout training via the keyword argument <code>epochs_per_θ_refresh</code>.</p><p><strong>Keyword arguments common to both <code>train</code> methods:</strong></p><ul><li><code>m</code>: sample sizes (either an <code>Integer</code> or a collection of <code>Integers</code>).</li><li><code>batchsize::Integer = 32</code></li><li><code>epochs::Integer = 100</code>: the maximum number of epochs used during training.</li><li><code>epochs_per_Z_refresh::Integer = 1</code>: how often to refresh the training data.</li><li><code>loss = mae</code>: the loss function, which should return an average loss when applied to multiple replicates.</li><li><code>optimiser = ADAM(1e-4)</code></li><li><code>savepath::String = &quot;runs/&quot;</code>: path to save the trained <code>θ̂</code> and other information.</li><li><code>stopping_epochs::Integer = 10</code>: halt training if the risk doesn&#39;t improve in <code>stopping_epochs</code> epochs.</li><li><code>use_gpu::Bool = true</code></li></ul><p><strong>Simulator keyword arguments only:</strong></p><ul><li><code>configs_per_epoch::Integer = 10_000</code>: how many parameters constitute a single epoch.</li><li><code>epochs_per_θ_refresh::Integer = 1</code>: how often to refresh the training parameters; this must be a multiple of <code>epochs_per_Z_refresh</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/msainsburydale/NeuralEstimators.jl/blob/409f69aac499efd89136ff204f3afda637c91bac/src/Train.jl#L13-L27">source</a></section><section><div><pre><code class="nohighlight hljs">train(θ̂, θ_train::P, θ_val::P; &lt;keyword args&gt;) where {P &lt;: ParameterConfigurations}</code></pre><p>Train the neural estimator <code>θ̂</code> by providing the training and validation sets explicitly as <code>θ_train</code> and <code>θ_val</code>, which are both held fixed during training.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/msainsburydale/NeuralEstimators.jl/blob/409f69aac499efd89136ff204f3afda637c91bac/src/Train.jl#L125-L130">source</a></section></article><h2 id="Estimation"><a class="docs-heading-anchor" href="#Estimation">Estimation</a><a id="Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Estimation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="NeuralEstimators.estimate" href="#NeuralEstimators.estimate"><code>NeuralEstimators.estimate</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">estimate(estimators, parameters::P, m; &lt;keyword args&gt;) where {P &lt;: ParameterConfigurations}</code></pre><p>Using a collection of <code>estimators</code>, compute estimates from data simulated from a set of <code>parameters</code>.</p><p><code>estimate()</code> requires the user to have defined a method <code>simulate(parameters, m::Integer)</code>.</p><p><strong>Keyword arguments</strong></p><ul><li><code>m::Vector{Integer} where I &lt;: Integer</code>: sample sizes to estimate from.</li><li><code>estimator_names::Vector{String}</code>: estimator names used when combining estimates into a <code>DataFrame</code> (e.g., <code>[&quot;NeuralEstimator&quot;, &quot;BayesEstimator&quot;, &quot;MLE&quot;]</code>), with sensible default values provided.</li><li><code>parameter_names::Vector{String}</code>: parameter names used when combining estimates into a <code>DataFrame</code> (e.g., <code>[&quot;μ&quot;, &quot;σ&quot;]</code>), with sensible default values provided.</li><li><code>num_rep::Integer = 1</code>: the number of times to replicate each parameter in <code>parameters</code> to reduce the effect of sample variability when assessing the estimators.</li><li><code>use_gpu = true</code>: should be a <code>Bool</code> or a collection of <code>Bool</code> objects with length equal to the number of estimators.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/msainsburydale/NeuralEstimators.jl/blob/409f69aac499efd89136ff204f3afda637c91bac/src/Estimate.jl#L1-L15">source</a></section></article><h2 id="Bootstrapping"><a class="docs-heading-anchor" href="#Bootstrapping">Bootstrapping</a><a id="Bootstrapping-1"></a><a class="docs-heading-anchor-permalink" href="#Bootstrapping" title="Permalink"></a></h2><p>Note that all bootstrapping functions are currently implemented for a single parameter configuration only.</p><article class="docstring"><header><a class="docstring-binding" id="NeuralEstimators.parametricbootstrap" href="#NeuralEstimators.parametricbootstrap"><code>NeuralEstimators.parametricbootstrap</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">parametricbootstrap(θ̂, parameters::P, m::Integer; B::Integer = 100, use_gpu::Bool = true) where {P &lt;: ParameterConfigurations}</code></pre><p>Returns <code>B</code> parameteric bootstrap samples of an estimator <code>θ̂</code> as a p × <code>B</code> matrix, where p is the number of parameters in the statistical model, based on simulated data sets of size <code>m</code>.</p><p>This function requires a method <code>simulate(parameters::P, m::Integer</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/msainsburydale/NeuralEstimators.jl/blob/409f69aac499efd89136ff204f3afda637c91bac/src/Bootstrap.jl#L3-L11">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NeuralEstimators.nonparametricbootstrap" href="#NeuralEstimators.nonparametricbootstrap"><code>NeuralEstimators.nonparametricbootstrap</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nonparametricbootstrap(θ̂, Z; B::Integer = 100, use_gpu::Bool = true)
nonparametricbootstrap(θ̂, Z, blocks; B::Integer = 100, use_gpu::Bool = true)</code></pre><p>Returns <code>B</code> non-parametric bootstrap samples of an estimator <code>θ̂</code> as a p × <code>B</code> matrix, where p is the number of parameters in the statistical model.</p><p>The argument <code>blocks</code> caters for block bootstrapping, and should be an integer vector specifying the block for each replicate. For example, if we have 5 replicates with the first two replicates corresponding to block 1 and the remaining replicates corresponding to block 2, then <code>blocks</code> should be [1, 1, 2, 2, 2]. The resampling algorithm tries to produce resampled data sets of a similar size to the original data, but this can only be achieved exactly if the blocks are the same length.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/msainsburydale/NeuralEstimators.jl/blob/409f69aac499efd89136ff204f3afda637c91bac/src/Bootstrap.jl#L20-L34">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../workflow/advanced/">« Advanced usage</a><a class="docs-footer-nextpage" href="../simulation/">Data simulation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Saturday 25 June 2022 07:45">Saturday 25 June 2022</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
